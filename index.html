<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>NewTower - Reloaded</title>
    <style>
        body { margin: 0; overflow: hidden; background: #222; font-family: 'Segoe UI', sans-serif; user-select: none; }
        
        /* Игровой слой */
        #game-container { position: relative; width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center; }
        canvas { box-shadow: 0 0 30px rgba(0,0,0,0.5); border-radius: 4px; }
        
        /* UI: Верхняя панель */
        #ui-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; }
        .top-bar { 
            position: absolute; top: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.8); padding: 10px 30px; border-radius: 20px;
            display: flex; gap: 30px; color: white; font-size: 20px; font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3); pointer-events: auto;
        }
        .stat { display: flex; align-items: center; gap: 8px; }
        .stat span { font-size: 24px; }

        /* UI: Нижняя панель (Карты) */
        #hand-panel {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            height: 140px; width: 600px;
            display: flex; justify-content: center; align-items: center; gap: 10px;
            pointer-events: auto;
        }
        
        /* UI: Кузница (Справа) */
        #forge-panel {
            position: absolute; bottom: 20px; right: 40px;
            width: 140px; height: 140px;
            background: rgba(0,0,0,0.6); border-radius: 15px; border: 2px solid #444;
            display: flex; flex-direction: column; align-items: center; justify-content: space-evenly;
            pointer-events: auto;
        }
        .forge-slots { display: flex; gap: 10px; }
        .slot { 
            width: 50px; height: 70px; background: rgba(0,0,0,0.3); border: 2px dashed #666; border-radius: 6px; 
            display: flex; justify-content: center; align-items: center;
        }
        #forge-btn {
            background: #ff9800; border: none; color: white; padding: 5px 15px; border-radius: 5px;
            cursor: pointer; font-weight: bold; font-size: 14px; width: 90%;
            transition: 0.2s;
        }
        #forge-btn:disabled { background: #555; color: #888; cursor: not-allowed; }

        /* Кнопка Старта */
        #start-wave-btn {
            position: absolute; top: 100px; right: 40px;
            width: 80px; height: 80px; border-radius: 50%;
            background: #d32f2f; border: 4px solid #b71c1c; color: white; font-size: 30px;
            cursor: pointer; box-shadow: 0 5px 15px rgba(0,0,0,0.4);
            pointer-events: auto; transition: transform 0.1s;
        }
        #start-wave-btn:active { transform: scale(0.95); }
        #start-wave-btn:disabled { background: #555; border-color: #333; cursor: default; }

        /* Карты (Стили) */
        .card {
            width: 70px; height: 100px; background: #fff; border-radius: 8px;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            position: relative; box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            cursor: grab; transition: transform 0.1s; border: 2px solid rgba(0,0,0,0.1);
        }
        .card:hover { transform: translateY(-10px); }
        .card-level { position: absolute; top: 4px; right: 4px; font-size: 12px; font-weight: bold; color: #333; }
        .card-icon { font-size: 32px; }
        
        /* Типы карт (Цвета) */
        .type-fire { background: #ffcdd2; border-bottom: 4px solid #f44336; }
        .type-ice { background: #b2ebf2; border-bottom: 4px solid #00bcd4; }
        .type-sniper { background: #c8e6c9; border-bottom: 4px